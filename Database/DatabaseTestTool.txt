/*
source /Users/Sofia/Desktop/Testverktyg/Database/DatabaseTestTool.txt;


*/

DROP  DATABASE TestTool;
CREATE DATABASE TestTool;
USE TestTool;

CREATE TABLE User(
		UserId INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
		FirstName VARCHAR(20) NOT NULL,
		LastName VARCHAR(20) NOT NULL,
		Mail VARCHAR(30) UNIQUE NOT NULL,
		Password VARCHAR(30) NOT NULL,
		Role VARCHAR(30) NOT NULL
		);

		DESCRIBE User;
    

CREATE TABLE Test(
		TestId INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
		TUserId INT,
		TTitle VARCHAR(20) NOT NULL,
		TDate DATE,
		TTimeMin INT(10) NOT NULL,
		TMaxPoints INT(10) NOT NULL,
		CONSTRAINT TUserIdFK FOREIGN KEY (TUserId) REFERENCES User(UserId)
		);	

CREATE TABLE Questions(
		QuestionId INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
		QTestId INT,
		Question VARCHAR(20) NOT NULL,
		QType VARCHAR(20) NOT NULL,
		QPoints INT(10) NOT NULL,
		QOrder INT(10) NOT NULL,
		CONSTRAINT QTestIdFK FOREIGN KEY (QTestId) REFERENCES Test(TestId)
		);	


CREATE TABLE Answers(
		AnswersId INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
		AQuestionId INT,
		AOrder INT(10) NOT NULL,
		APoints INT(10) NOT NULL,
		ACorrected BOOLEAN NOT NULL,
		AText VARCHAR(20) NOT NULL,
		CONSTRAINT AQuestionIdFK FOREIGN KEY (AQuestionId) REFERENCES Questions(QuestionId)
		);										

CREATE TABLE AnsweredTest(
		ATestId INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
		ATAnswersId INT,
		ATDate DATE NOT NULL,
		ATCorrected BOOLEAN NOT NULL,
		ATPoints INT(10) NOT NULL,
		ATGrade INT(10) NOT NULL,
		CONSTRAINT ATAnswersIdFK FOREIGN KEY (ATAnswersId) REFERENCES Answers(AnswersId)
		);					

CREATE TABLE UserAnswer(
		UserAnswerId INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
		UAUserId INT,
		UAAnswersId INT,
		UADate DATE NOT NULL,
		UACorrected BOOLEAN NOT NULL,
		UAPoints INT(10) NOT NULL,
		UAGrade INT(10) NOT NULL,
		CONSTRAINT UAAnswersIdFK FOREIGN KEY (UAAnswersId) REFERENCES Answers(AnswersId),
		CONSTRAINT UAUserIdFK FOREIGN KEY (UAUserId) REFERENCES User(UserId)
		);		
